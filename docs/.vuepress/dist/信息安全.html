<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>哈希算法 | 个人主页</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="CZT的博客">
    
    <link rel="preload" href="/assets/css/0.styles.e8e4f3a3.css" as="style"><link rel="preload" href="/assets/js/app.c780e1b6.js" as="script"><link rel="preload" href="/assets/js/2.f44a4f26.js" as="script"><link rel="preload" href="/assets/js/19.cfc57187.js" as="script"><link rel="prefetch" href="/assets/js/10.207c4431.js"><link rel="prefetch" href="/assets/js/11.747359fa.js"><link rel="prefetch" href="/assets/js/12.6c286f4f.js"><link rel="prefetch" href="/assets/js/13.c0822fad.js"><link rel="prefetch" href="/assets/js/14.75e13154.js"><link rel="prefetch" href="/assets/js/15.cf4291c4.js"><link rel="prefetch" href="/assets/js/16.babfb68b.js"><link rel="prefetch" href="/assets/js/17.600473bc.js"><link rel="prefetch" href="/assets/js/18.0b6e0252.js"><link rel="prefetch" href="/assets/js/20.dec901f2.js"><link rel="prefetch" href="/assets/js/21.bfa49832.js"><link rel="prefetch" href="/assets/js/22.a31f4be5.js"><link rel="prefetch" href="/assets/js/23.7019856d.js"><link rel="prefetch" href="/assets/js/24.45adeb21.js"><link rel="prefetch" href="/assets/js/25.43428e77.js"><link rel="prefetch" href="/assets/js/26.f37e9ddb.js"><link rel="prefetch" href="/assets/js/27.241fb6ed.js"><link rel="prefetch" href="/assets/js/28.1bf839c4.js"><link rel="prefetch" href="/assets/js/29.bbb07d62.js"><link rel="prefetch" href="/assets/js/3.1aa3be4a.js"><link rel="prefetch" href="/assets/js/30.7ca7bc7e.js"><link rel="prefetch" href="/assets/js/4.7ac2b204.js"><link rel="prefetch" href="/assets/js/5.f702624b.js"><link rel="prefetch" href="/assets/js/6.c76c0e1e.js"><link rel="prefetch" href="/assets/js/7.414750dc.js"><link rel="prefetch" href="/assets/js/8.bc490d6c.js"><link rel="prefetch" href="/assets/js/9.0cb2026c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e8e4f3a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">个人主页</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java基础.html" class="nav-link">
  Java基础
</a></li><li class="dropdown-item"><!----> <a href="/Java高级.html" class="nav-link">
  Java高级
</a></li><li class="dropdown-item"><!----> <a href="/Java并发.html" class="nav-link">
  Java并发
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/MySQL.html" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/数据库.html" class="nav-link">
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/Redis.html" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/存储.html" class="nav-link">
  存储
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java基础.html" class="nav-link">
  Java基础
</a></li><li class="dropdown-item"><!----> <a href="/Java高级.html" class="nav-link">
  Java高级
</a></li><li class="dropdown-item"><!----> <a href="/Java并发.html" class="nav-link">
  Java并发
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/MySQL.html" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/数据库.html" class="nav-link">
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/Redis.html" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/存储.html" class="nav-link">
  存储
</a></li></ul></div></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="哈希算法"><a href="#哈希算法" class="header-anchor">#</a> 哈希算法</h1> <p>哈希算法（Hash）又称摘要算法（Digest），作用：对任意一组输入数据进行计算，得到一个固定长度的输出摘要。</p> <p>哈希算法的目的就是为了验证原始数据是否被篡改。</p> <p><strong>特点</strong></p> <ul><li>相同的输入一定得到相同的输出；</li> <li>不同的输入大概率得到不同的输出。</li></ul> <p><strong>哈希碰撞</strong></p> <p>两个不同的输入得到了<strong>相同</strong>的输出，碰撞是不可避免的，碰撞概率的高低关系到哈希算法的安全性。一个安全的哈希算法必须满足：</p> <ul><li>碰撞概率低；</li> <li>不能猜测输出。</li></ul> <p><strong>常用哈希算法</strong></p> <table><thead><tr><th style="text-align:left;">算法</th> <th style="text-align:left;">输出长度（位）</th> <th style="text-align:left;">输出长度（字节）</th></tr></thead> <tbody><tr><td style="text-align:left;">MD5</td> <td style="text-align:left;">128 bits</td> <td style="text-align:left;">16 bytes</td></tr> <tr><td style="text-align:left;">SHA-1</td> <td style="text-align:left;">160 bits</td> <td style="text-align:left;">20 bytes</td></tr> <tr><td style="text-align:left;">RipeMD-160</td> <td style="text-align:left;">160 bits</td> <td style="text-align:left;">20 bytes</td></tr> <tr><td style="text-align:left;">SHA-256</td> <td style="text-align:left;">256 bits</td> <td style="text-align:left;">32 bytes</td></tr> <tr><td style="text-align:left;">SHA-512</td> <td style="text-align:left;">512 bits</td> <td style="text-align:left;">64 bytes</td></tr></tbody></table> <p>根据碰撞概率，哈希算法的<strong>输出长度越长</strong>，就越难产生碰撞，也就越安全。</p> <h2 id="用途"><a href="#用途" class="header-anchor">#</a> 用途</h2> <ol><li><p>验证数据、文件是否被篡改</p> <p>自己计算一下本地文件的哈希值，再与官网公开的哈希值对比，如果相同，说明文件下载正确，否则，说明文件已被篡改。</p></li> <li><p>存储用户口令</p> <p>如果直接将用户的原始口令存放到数据库中，会产生极大的安全风险：</p> <ul><li>数据库管理员能够看到用户明文口令；</li> <li>数据库数据一旦泄漏，黑客即可获取用户明文口令。</li></ul> <p>不存储用户的原始口令，那么如何对用户进行认证？方法是存储用户口令的哈希，例如，MD5。</p> <p>在用户输入原始口令后，系统计算用户输入的原始口令的MD5并与数据库存储的MD5对比，如果一致，说明口令正确，否则，口令错误。</p> <p>因此，数据库存储用户名和口令的表内容应该像下面这样：</p> <table><thead><tr><th style="text-align:left;">username</th> <th style="text-align:left;">password</th></tr></thead> <tbody><tr><td style="text-align:left;">bob</td> <td style="text-align:left;">f30aa7a662c728b7407c54ae6bfd27d1</td></tr> <tr><td style="text-align:left;">alice</td> <td style="text-align:left;">25d55ad283aa400af464c76d713c07ad</td></tr> <tr><td style="text-align:left;">tim</td> <td style="text-align:left;">bed128365216c019988915ed3add75fb</td></tr></tbody></table> <p>这样一来，数据库管理员看不到用户的原始口令。即使数据库泄漏，黑客也无法拿到用户的原始口令。想要拿到用户的原始口令，必须用暴力穷举的方法，一个口令一个口令地试，直到某个口令计算的MD5恰好等于指定值。</p></li></ol> <p><strong>彩虹表</strong></p> <p>使用哈希口令时，还要注意防止<strong>彩虹表</strong>攻击。彩虹表就是常用口令的哈希表，如果用户使用了常用口令，黑客从MD5一下就能反查到原始口令</p> <table><thead><tr><th style="text-align:left;">常用口令</th> <th style="text-align:left;">MD5</th></tr></thead> <tbody><tr><td style="text-align:left;">hello123</td> <td style="text-align:left;">f30aa7a662c728b7407c54ae6bfd27d1</td></tr> <tr><td style="text-align:left;">12345678</td> <td style="text-align:left;">25d55ad283aa400af464c76d713c07ad</td></tr> <tr><td style="text-align:left;">passw0rd</td> <td style="text-align:left;">bed128365216c019988915ed3add75fb</td></tr> <tr><td style="text-align:left;">19700101</td> <td style="text-align:left;">570da6d5277a646f6552b8832012f5dc</td></tr> <tr><td style="text-align:left;">…</td> <td style="text-align:left;">…</td></tr> <tr><td style="text-align:left;">20201231</td> <td style="text-align:left;">6879c0ae9117b50074ce0a0d4c843060</td></tr></tbody></table> <p><strong>解决办法</strong></p> <p>加盐（salt）：对每个口令额外添加随机数。目的在于使黑客的彩虹表失效，即使用户使用常用口令，也无法从MD5反推原始口令。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>digest = md5(salt+inputPassword)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>加盐处理后的数据库表：</p> <table><thead><tr><th style="text-align:left;">username</th> <th style="text-align:left;">salt</th> <th style="text-align:left;">password</th></tr></thead> <tbody><tr><td style="text-align:left;">bob</td> <td style="text-align:left;">H1r0a</td> <td style="text-align:left;">a5022319ff4c56955e22a74abcc2c210</td></tr> <tr><td style="text-align:left;">alice</td> <td style="text-align:left;">7$p2w</td> <td style="text-align:left;">e5de688c99e961ed6e560b972dab8b6a</td></tr> <tr><td style="text-align:left;">tim</td> <td style="text-align:left;">z5Sk9</td> <td style="text-align:left;">1eee304b92dc0d105904e7ab58fd2f64</td></tr></tbody></table> <p>java用信息摘要类MessageDigest计算哈希：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建一个MessageDigest实例，并指定使用的哈希算法:</span>
    <span class="token class-name">MessageDigest</span> md <span class="token operator">=</span> <span class="token class-name">MessageDigest</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;SHA-1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 支持常用哈希算法</span>
    <span class="token comment">// 反复调用update输入数据:</span>
    md<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    md<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&quot;World&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 计算哈希</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> md<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 20 bytes: db8ac1c259eb89d4a131b253bacfca5f319d54f2</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c780e1b6.js" defer></script><script src="/assets/js/2.f44a4f26.js" defer></script><script src="/assets/js/19.cfc57187.js" defer></script>
  </body>
</html>
